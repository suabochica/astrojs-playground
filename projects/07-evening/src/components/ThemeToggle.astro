---
import ThemeIcon from '@/icons/ThemeColor.astro'
---

<button
  id="themeToggle"
  class="hover:scale-125 hover:opacity-70 transition inline-block text-primary/80"
>
  <ThemeIcon />
  <span class="sr-only">Toggle Theme</span>
</button>

<script is:inline>
  const getThemePreferences = () => {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      return localStorage.getItem('theme');
    }

    return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  }

  const isDark = getThemePreferences() === 'dark';

  document.documentElement.classList[isDark ? 'add' : 'remove']('dark');

  const handleToggleClick = () => {
    const element = document.documentElement;

    element.classList.toggle('dark');

    const isDark = element.classList.contains('dark');

    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  }

  document.getElementById('themeToggle').addEventListener('click', handleToggleClick);
</script>